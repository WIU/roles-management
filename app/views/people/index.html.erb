<%= javascript_include_tag "jquery.googlemaps.pack.1.01.js" %>

<div class="block">
	<div class="block_head">
		<div class="bheadl"></div>
		<div class="bheadr"></div>
		
		<h2>People</h2>
	</div> <!-- .block_head -->
	
	<div class="block_content">
		
		<table>
		  <tr>
		    <th>Name</th>
		    <th>Email</th>
		    <th style="min-width: 9em;">Phone</th>
		    <th>Address</th>
		    <th>Login</th>
		  </tr>
		<% @people.each do |person| %>
		  <tr>
		    <td><%= link_to person.preferred_name, person %></td>
		    <td><%= mail_to person.email, person.email, :encode => "javascript" %></td>
		    <td><% if person.phone != nil and person.phone.length > 0 %>
				<%= number_to_phone person.phone, :area_code => true %>
				<% end %>
			</td>
		    <td><a href="#map_popup" rel="facebox"><%= person.address %></a></td>
		    <td><%= person.loginid %></td>
		  </tr>
		<% end %>
		</table>

		<br />

		<%= link_to 'New Person', new_person_path %>
		
	</div> <!-- .block_content -->
	
	<div class="bendl"></div>
	<div class="bendr"></div>
</div> <!-- .block -->

<div id="map_popup" class="hidden">
	<div id="map_canvas" style="width: 300px; height: 250px;"></div>
	<script type="text/javascript">
		$(document).ready(function() { 
			$('div#map_canvas').googleMaps({
				geocode: '320 - 507 West Broadway Vancouver, BC V5Z 0B4'
			}); 
		});
	</script>
</div> <!-- map_popup -->
